# gramm4Matlab
the Matlab code of GRaMM strategy


GRaMM is designed specifically for inter-correlation identification between metabolome and microbiome. It can detect both linear and nonlinear correlations, both function and nonfunction relationships. The main workflows contain: (1) data preprocessing, (2) identifying linear or nonlinear correlation, (3) correlation analysis, (4) the p value adjustment.
The preprocessing of metabolic variables includes log transformation and normalization by sample total intensity. Microbial variables will be normalized by sample total abundance if they have not been, and then will be transformed using the centered log-ratio (CLR) transformation. Step 2 is to identify roughly the correlation type. Since the linear relationship is simple and is favorable in most cases, LR will be applied to the pair and the p and r values will be obtained. Based on the threshold values of p and/or r, this pair will be handled by different arms. Step 3, for a linear correlation (e.g. LR p<0.05), results of LR will be outputted directly when there are no confounders. Or, multiple linear regression (mLR) will be applied, taking the metabolic variables as y and the microbial variables and confounders as x. The adjusted p and r values will be outputted. For a nonlinear correlation (e.g. LR p>0.05), MIC will be conducted and the p and r values will be outputted directly when there are no confounders. When there are confounders, the variables will be processed by the Metabolic Confounding Effect Elimination (MCEE) before the application of MIC. Besides, GRaMM will conduct curve fitting using 5 typical models (Table. S4) for a nonlinear correlated pair and output the best one. Finally, step 4, the p value will be adjusted using Benjamini-Hochberg to control the multiple testing false discovery rate (FDR).
